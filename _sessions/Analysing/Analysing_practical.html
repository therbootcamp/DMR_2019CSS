<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Analysing</title>

<script src="Analysing_practical_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="Analysing_practical_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="Analysing_practical_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="Analysing_practical_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="Analysing_practical_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="Analysing_practical_files/navigation-1.1/tabsets.js"></script>
<link href="Analysing_practical_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="Analysing_practical_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="practical.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->





<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Analysing</h1>
<h4 class="author"><em><table style='table-layout:fixed;width:100%;border:0;padding:0;margin:0'>
<col width='10%'>
<col width='10%'>
<tr style="border:none">
<td style="display:block;width:100%;text-align:left;vertical-align:bottom;padding:0;margin:0;border:none" nowrap>
<font style='font-style:normal'>R for Data Science</font><br> <a href='https://therbootcamp.github.io/R4DS_2019Feb/'> <i class='fas fa-clock' style='font-size:.9em;' ></i> </a> <a href='https://therbootcamp.github.io'> <i class='fas fa-home' style='font-size:.9em;'></i> </a> <a href='mailto:therbootcamp@gmail.com'> <i class='fas fa-envelope' style='font-size: .9em;'></i> </a> <a href='https://www.linkedin.com/company/basel-r-bootcamp/'> <i class='fab fa-linkedin' style='font-size: .9em;'></i> </a> <a href='https://therbootcamp.github.io'> <font style='font-style:normal'>Basel R Bootcamp</font> </a>
</td>
<td style="width:100%;vertical-align:bottom;text-align:right;padding:0;margin:0;border:none">
<img src='https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/by-sa.png' style='height:15px;width:80px'/>
</td>
</tr>
</table></em></h4>

</div>


<p align="center">
<img width="100%" src="image/forsale.png" margin=0><br> <font style="font-size:10px">adapted from <a href="http://www.trueloveproperty.co.uk/houses-sale-ingham/">trueloveproperty.co.uk</a></font>
</p>
<div id="section" class="section level1 tabset">
<h1></h1>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>In this practical, you’ll practice grouping and analysing data with <code>dplyr</code></p>
<p>By the end of this practical you will know how to:</p>
<ol style="list-style-type: decimal">
<li>Group data and calculate summary statistics</li>
<li>Run statistical analyses with the generalised linear model.</li>
</ol>
</div>
<div id="tasks" class="section level2">
<h2>Tasks</h2>
<div id="a---setup" class="section level3">
<h3>A - Setup</h3>
<ol style="list-style-type: decimal">
<li>Open your <code>BaselRBootcamp</code> R project. It should already have the folders <code>1_Data</code> and <code>2_Code</code>. Make sure that the data files listed in the <code>Datasets</code> section above are in your <code>1_Data</code> folder.</li>
</ol>
<pre class="r"><code># Done!</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Open a new R script. At the top of the script, using comments, write your name and the date and “Analysing Practical”.</li>
</ol>
<pre class="r"><code>## NAME
## DATE
## Analysing Practical</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><p>Save it as a new file called <code>analysing_practical.R</code> in the <code>2_Code</code> folder.</p></li>
<li><p>Using <code>library()</code> load the <code>tidyverse</code> and <code>broom</code> packages for this practical listed in the Functions section above. If you don’t have them installed, you’ll need to install them, see the Functions tab above for installation instructions.</p></li>
</ol>
<pre class="r"><code># Load packages
library(tidyverse)     
library(broom)</code></pre>
<pre class="r"><code>library(tidyverse)
library(broom)</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>For this practical, we’ll use the <code>kc_house.csv</code> data. This dataset contains house sale prices for King County, Washington. It includes homes sold between May 2014 and May 2015. Using the following template, load the data into R and store it as a new object called <code>kc_house</code>.</li>
</ol>
<pre class="r"><code>kc_house &lt;- read_csv(file = &quot;XX/XX&quot;)</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Using <code>print()</code>, <code>dim()</code>, <code>summary()</code>, <code>head()</code>, and <code>View()</code>, explore the data to make sure it was loaded correctly.</li>
</ol>
<pre class="r"><code>kc_house</code></pre>
<pre><code># A tibble: 21,613 x 21
   id    date                 price bedrooms bathrooms sqft_living sqft_lot
   &lt;chr&gt; &lt;dttm&gt;               &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;
 1 7129… 2014-10-13 00:00:00 2.22e5        3      1           1180     5650
 2 6414… 2014-12-09 00:00:00 5.38e5        3      2.25        2570     7242
 3 5631… 2015-02-25 00:00:00 1.80e5        2      1            770    10000
 4 2487… 2014-12-09 00:00:00 6.04e5        4      3           1960     5000
 5 1954… 2015-02-18 00:00:00 5.10e5        3      2           1680     8080
 6 7237… 2014-05-12 00:00:00 1.23e6        4      4.5         5420   101930
 7 1321… 2014-06-27 00:00:00 2.58e5        3      2.25        1715     6819
 8 2008… 2015-01-15 00:00:00 2.92e5        3      1.5         1060     9711
 9 2414… 2015-04-15 00:00:00 2.30e5        3      1           1780     7470
10 3793… 2015-03-12 00:00:00 3.23e5        3      2.5         1890     6560
# … with 21,603 more rows, and 14 more variables: floors &lt;dbl&gt;,
#   waterfront &lt;dbl&gt;, view &lt;dbl&gt;, condition &lt;dbl&gt;, grade &lt;dbl&gt;,
#   sqft_above &lt;dbl&gt;, sqft_basement &lt;dbl&gt;, yr_built &lt;dbl&gt;,
#   yr_renovated &lt;dbl&gt;, zipcode &lt;dbl&gt;, lat &lt;dbl&gt;, long &lt;dbl&gt;,
#   sqft_living15 &lt;dbl&gt;, sqft_lot15 &lt;dbl&gt;</code></pre>
<pre class="r"><code>dim(kc_house)</code></pre>
<pre><code>[1] 21613    21</code></pre>
<pre class="r"><code>summary(kc_house)</code></pre>
<pre><code>      id                 date                         price        
 Length:21613       Min.   :2014-05-02 00:00:00   Min.   :  75000  
 Class :character   1st Qu.:2014-07-22 00:00:00   1st Qu.: 321950  
 Mode  :character   Median :2014-10-16 00:00:00   Median : 450000  
                    Mean   :2014-10-29 04:38:01   Mean   : 540088  
                    3rd Qu.:2015-02-17 00:00:00   3rd Qu.: 645000  
                    Max.   :2015-05-27 00:00:00   Max.   :7700000  
    bedrooms      bathrooms     sqft_living       sqft_lot      
 Min.   : 0.0   Min.   :0.00   Min.   :  290   Min.   :    520  
 1st Qu.: 3.0   1st Qu.:1.75   1st Qu.: 1427   1st Qu.:   5040  
 Median : 3.0   Median :2.25   Median : 1910   Median :   7618  
 Mean   : 3.4   Mean   :2.11   Mean   : 2080   Mean   :  15107  
 3rd Qu.: 4.0   3rd Qu.:2.50   3rd Qu.: 2550   3rd Qu.:  10688  
 Max.   :33.0   Max.   :8.00   Max.   :13540   Max.   :1651359  
     floors       waterfront         view        condition   
 Min.   :1.00   Min.   :0.000   Min.   :0.00   Min.   :1.00  
 1st Qu.:1.00   1st Qu.:0.000   1st Qu.:0.00   1st Qu.:3.00  
 Median :1.50   Median :0.000   Median :0.00   Median :3.00  
 Mean   :1.49   Mean   :0.008   Mean   :0.23   Mean   :3.41  
 3rd Qu.:2.00   3rd Qu.:0.000   3rd Qu.:0.00   3rd Qu.:4.00  
 Max.   :3.50   Max.   :1.000   Max.   :4.00   Max.   :5.00  
     grade         sqft_above   sqft_basement     yr_built   
 Min.   : 1.00   Min.   : 290   Min.   :   0   Min.   :1900  
 1st Qu.: 7.00   1st Qu.:1190   1st Qu.:   0   1st Qu.:1951  
 Median : 7.00   Median :1560   Median :   0   Median :1975  
 Mean   : 7.66   Mean   :1788   Mean   : 292   Mean   :1971  
 3rd Qu.: 8.00   3rd Qu.:2210   3rd Qu.: 560   3rd Qu.:1997  
 Max.   :13.00   Max.   :9410   Max.   :4820   Max.   :2015  
  yr_renovated     zipcode           lat            long     
 Min.   :   0   Min.   :98001   Min.   :47.2   Min.   :-122  
 1st Qu.:   0   1st Qu.:98033   1st Qu.:47.5   1st Qu.:-122  
 Median :   0   Median :98065   Median :47.6   Median :-122  
 Mean   :  84   Mean   :98078   Mean   :47.6   Mean   :-122  
 3rd Qu.:   0   3rd Qu.:98118   3rd Qu.:47.7   3rd Qu.:-122  
 Max.   :2015   Max.   :98199   Max.   :47.8   Max.   :-121  
 sqft_living15    sqft_lot15    
 Min.   : 399   Min.   :   651  
 1st Qu.:1490   1st Qu.:  5100  
 Median :1840   Median :  7620  
 Mean   :1987   Mean   : 12768  
 3rd Qu.:2360   3rd Qu.: 10083  
 Max.   :6210   Max.   :871200  </code></pre>
<pre class="r"><code>head(kc_house)</code></pre>
<pre><code># A tibble: 6 x 21
  id    date                 price bedrooms bathrooms sqft_living sqft_lot
  &lt;chr&gt; &lt;dttm&gt;               &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;
1 7129… 2014-10-13 00:00:00 2.22e5        3      1           1180     5650
2 6414… 2014-12-09 00:00:00 5.38e5        3      2.25        2570     7242
3 5631… 2015-02-25 00:00:00 1.80e5        2      1            770    10000
4 2487… 2014-12-09 00:00:00 6.04e5        4      3           1960     5000
5 1954… 2015-02-18 00:00:00 5.10e5        3      2           1680     8080
6 7237… 2014-05-12 00:00:00 1.23e6        4      4.5         5420   101930
# … with 14 more variables: floors &lt;dbl&gt;, waterfront &lt;dbl&gt;, view &lt;dbl&gt;,
#   condition &lt;dbl&gt;, grade &lt;dbl&gt;, sqft_above &lt;dbl&gt;, sqft_basement &lt;dbl&gt;,
#   yr_built &lt;dbl&gt;, yr_renovated &lt;dbl&gt;, zipcode &lt;dbl&gt;, lat &lt;dbl&gt;,
#   long &lt;dbl&gt;, sqft_living15 &lt;dbl&gt;, sqft_lot15 &lt;dbl&gt;</code></pre>
<pre class="r"><code># View(kc_house)</code></pre>
</div>
<div id="b---recap" class="section level3">
<h3>B - Recap</h3>
<ol style="list-style-type: decimal">
<li>Print the names of the <code>kc_house</code> data with <code>names()</code>.</li>
</ol>
<pre class="r"><code>names(kc_house)</code></pre>
<pre><code> [1] &quot;id&quot;            &quot;date&quot;          &quot;price&quot;         &quot;bedrooms&quot;     
 [5] &quot;bathrooms&quot;     &quot;sqft_living&quot;   &quot;sqft_lot&quot;      &quot;floors&quot;       
 [9] &quot;waterfront&quot;    &quot;view&quot;          &quot;condition&quot;     &quot;grade&quot;        
[13] &quot;sqft_above&quot;    &quot;sqft_basement&quot; &quot;yr_built&quot;      &quot;yr_renovated&quot; 
[17] &quot;zipcode&quot;       &quot;lat&quot;           &quot;long&quot;          &quot;sqft_living15&quot;
[21] &quot;sqft_lot15&quot;   </code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Change the following column names using <code>rename()</code>.</li>
</ol>
<table>
<thead>
<tr class="header">
<th align="left">New Name</th>
<th align="left">Old Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">living_sqft</td>
<td align="left">sqft_living</td>
</tr>
<tr class="even">
<td align="left">lot_sqft</td>
<td align="left">sqft_lot</td>
</tr>
<tr class="odd">
<td align="left">above_sqft</td>
<td align="left">sqft_above</td>
</tr>
<tr class="even">
<td align="left">basement_sqft</td>
<td align="left">sqft_basement</td>
</tr>
<tr class="odd">
<td align="left">built_yr</td>
<td align="left">yr_built</td>
</tr>
<tr class="even">
<td align="left">renovated_yr</td>
<td align="left">yr_renovated</td>
</tr>
</tbody>
</table>
<ol start="3" style="list-style-type: decimal">
<li>Add new column(s) <code>living_sqm</code>, <code>above_sqm</code> and <code>basement_sqm</code> which show the respective room sizes in square meters rather than square feet (Hint: Multiply each by 0.093).</li>
</ol>
<pre class="r"><code>kc_house &lt;- kc_house %&gt;%
  mutate(living_sqm = living_sqft * 0.093,
         XXX = XXX * XXX,
         XXX = XXX * XXX)</code></pre>
<pre class="r"><code>kc_house &lt;- kc_house %&gt;%
  mutate(living_sqm = living_sqft * 0.093,
         above_sqm = above_sqft * 0.093,
         basement_sqm  = basement_sqft * 0.093)</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Add a new column <code>total_sqm</code> which is the sum of <code>living_sqm</code>, <code>above_sqm</code> and <code>basement_sqm</code></li>
</ol>
<pre class="r"><code>kc_house &lt;- kc_house %&gt;%
  mutate(total_sqm = living_sqm + above_sqm + basement_sqm)</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Add a new variable to the dataframe called <code>mansion</code> which is “Yes” when <code>total_sqm</code> is greater than 750, and “No” when <code>total_sqm</code> is less than or equal to 750.</li>
</ol>
<pre class="r"><code>kc_house &lt;- kc_house %&gt;%
                mutate(XXX = case_when(XXX &gt; XXX ~ &quot;XXX&quot;,
                                       XXX &lt;= XXX ~ &quot;XXX&quot;))</code></pre>
<pre class="r"><code>kc_house &lt;- kc_house %&gt;%
                mutate(mansion = case_when(
                              total_sqm &gt; 750 ~ &quot;Yes&quot;,
                              total_sqm &lt;= 750~ &quot;No&quot;))</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>How many mansions are there in the data and how many non mansions are there? Answer this by running <code>table(kc_house$mansion)</code>. You should find 751 mansions and 20862 non-mansions!</li>
</ol>
</div>
<div id="c---simple-summaries" class="section level3">
<h3>C - Simple summaries</h3>
<ol style="list-style-type: decimal">
<li>Using the base-R <code>df$col</code> notation, calculate the mean price of all houses.</li>
</ol>
<pre class="r"><code>mean(XXX$XXX)</code></pre>
<pre class="r"><code>mean(kc_house$price)</code></pre>
<pre><code>[1] 540088</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Now, do the same using <code>summarise()</code> using the following template. Do you get the same answer? What is different about the output from <code>summarise()</code> versus using the dollar sign?</li>
</ol>
<pre class="r"><code>kc_house %&gt;%
  summarise(
    price_mean = mean(XXX)
  )</code></pre>
<pre class="r"><code>kc_house %&gt;%
  summarise(
    price_mean = mean(price)
  )</code></pre>
<pre><code># A tibble: 1 x 1
  price_mean
       &lt;dbl&gt;
1    540088.</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>What is the <em>median</em> price of all houses? Use the <code>median()</code> function!</li>
</ol>
<pre class="r"><code>kc_house %&gt;%
  summarise(
    price_median = median(price)
  )</code></pre>
<pre><code># A tibble: 1 x 1
  price_median
         &lt;dbl&gt;
1       450000</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>What was the highest selling price? Use the <code>max()</code> function!</li>
</ol>
<pre class="r"><code>kc_house %&gt;%
  summarise(
    price_max = max(price)
  )</code></pre>
<pre><code># A tibble: 1 x 1
  price_max
      &lt;dbl&gt;
1   7700000</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Using the following template, sort the data frame in descending order of price. Then, print it. Do you see the house with the highest selling price at the top?</li>
</ol>
<pre class="r"><code>kc_house &lt;- kc_house %&gt;%
  arrange(desc(XXX))

kc_house</code></pre>
<pre class="r"><code>kc_house &lt;- kc_house %&gt;%
  arrange(desc(price))

kc_house</code></pre>
<pre><code># A tibble: 21,613 x 26
   id    date                 price bedrooms bathrooms living_sqft lot_sqft
   &lt;chr&gt; &lt;dttm&gt;               &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;
 1 6762… 2014-10-13 00:00:00 7.70e6        6      8          12050    27600
 2 9808… 2014-06-11 00:00:00 7.06e6        5      4.5        10040    37325
 3 9208… 2014-09-19 00:00:00 6.88e6        6      7.75        9890    31374
 4 2470… 2014-08-04 00:00:00 5.57e6        5      5.75        9200    35069
 5 8907… 2015-04-13 00:00:00 5.35e6        5      5           8000    23985
 6 7558… 2015-04-13 00:00:00 5.30e6        6      6           7390    24829
 7 1247… 2014-10-20 00:00:00 5.11e6        5      5.25        8010    45517
 8 1924… 2014-06-17 00:00:00 4.67e6        5      6.75        9640    13068
 9 7738… 2014-08-15 00:00:00 4.50e6        5      5.5         6640    40014
10 3835… 2014-06-18 00:00:00 4.49e6        4      3           6430    27517
# … with 21,603 more rows, and 19 more variables: floors &lt;dbl&gt;,
#   waterfront &lt;dbl&gt;, view &lt;dbl&gt;, condition &lt;dbl&gt;, grade &lt;dbl&gt;,
#   above_sqft &lt;dbl&gt;, basement_sqft &lt;dbl&gt;, built_yr &lt;dbl&gt;,
#   renovated_yr &lt;dbl&gt;, zipcode &lt;dbl&gt;, lat &lt;dbl&gt;, long &lt;dbl&gt;,
#   sqft_living15 &lt;dbl&gt;, sqft_lot15 &lt;dbl&gt;, living_sqm &lt;dbl&gt;,
#   above_sqm &lt;dbl&gt;, basement_sqm &lt;dbl&gt;, total_sqm &lt;dbl&gt;, mansion &lt;chr&gt;</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>What percentage of houses sold for more than 1,000,000? Let’s answer this with <code>summarise()</code>.</li>
</ol>
<pre class="r"><code>kc_house %&gt;%
  summarise(mil_p = mean(XXX &gt; 1000000))</code></pre>
<pre class="r"><code>kc_house %&gt;%
  summarise(mil_p = mean(price &gt; 1000000))</code></pre>
<pre><code># A tibble: 1 x 1
   mil_p
   &lt;dbl&gt;
1 0.0678</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>For mansions <em>only</em>, calculate the mean number of floors and bathrooms (hint: before summarising the data, use <code>filter()</code> to only select mansions!)</li>
</ol>
<pre class="r"><code>kc_house %&gt;%
  filter(mansion == &quot;Yes&quot;) %&gt;%
  summarise(
    floors_mean = mean(floors),
    bathrooms_mean = mean(bathrooms)
  )</code></pre>
<pre><code># A tibble: 1 x 2
  floors_mean bathrooms_mean
        &lt;dbl&gt;          &lt;dbl&gt;
1        1.92           3.68</code></pre>
</div>
<div id="d---simple-grouped-summaries" class="section level3">
<h3>D - Simple grouped summaries</h3>
<ol style="list-style-type: decimal">
<li>How many mansions are there? To do this, use <code>group_by()</code> to group the dataset by the <code>mansion</code> column, then use the <code>n()</code> function to count the number of cases.</li>
</ol>
<pre class="r"><code>kc_house %&gt;%
  group_by(XXX) %&gt;%
  summarise(XXX = n())</code></pre>
<pre class="r"><code>kc_house %&gt;%
  group_by(mansion) %&gt;%
  summarise(N = n())</code></pre>
<pre><code># A tibble: 2 x 2
  mansion     N
  &lt;chr&gt;   &lt;int&gt;
1 No      20862
2 Yes       751</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>What is the mean selling price of mansions versus non-mansions? To do this, just add another argument to your <code>summarise()</code> function!</li>
</ol>
<pre class="r"><code>kc_house %&gt;%
  group_by(mansion) %&gt;%
  summarise(N = n(),
            XXX = XXX(XXX))</code></pre>
<pre class="r"><code>kc_house %&gt;%
  group_by(mansion) %&gt;%
  summarise(N = n(),
            price_mean = mean(price))</code></pre>
<pre><code># A tibble: 2 x 3
  mansion     N price_mean
  &lt;chr&gt;   &lt;int&gt;      &lt;dbl&gt;
1 No      20862    504024.
2 Yes       751   1541915.</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Using <code>group_by()</code> and <code>summarise()</code>, create a dataframe showing the same results as the following table.</li>
</ol>
<table>
<thead>
<tr class="header">
<th align="left">mansion</th>
<th align="right">N</th>
<th align="right">price_min</th>
<th align="right">price_mean</th>
<th align="right">price_median</th>
<th align="right">price_max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">No</td>
<td align="right">20862</td>
<td align="right">75000</td>
<td align="right">504024</td>
<td align="right">441000</td>
<td align="right">3100000</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
<td align="right">751</td>
<td align="right">404000</td>
<td align="right">1541915</td>
<td align="right">1300000</td>
<td align="right">7700000</td>
</tr>
</tbody>
</table>
<ol start="4" style="list-style-type: decimal">
<li>Do houses built in later years tend to have more living space? To answer this, group the data by <code>built_yr</code>, and then calculate the mean number of living square meters. Be sure to also include the number of houses built in each year!</li>
</ol>
<pre class="r"><code>kc_house %&gt;%
  group_by(built_yr) %&gt;%
  summarise(N = n(),
            living = mean(living_sqm))</code></pre>
<pre><code># A tibble: 116 x 3
   built_yr     N living
      &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;
 1     1900    87   161.
 2     1901    29   164.
 3     1902    27   179.
 4     1903    46   140.
 5     1904    45   149.
 6     1905    74   183.
 7     1906    92   168.
 8     1907    65   177.
 9     1908    86   158.
10     1909    94   177.
# … with 106 more rows</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Was that table too big? Try using the following code to get the results for each decade rather than each year!</li>
</ol>
<pre class="r"><code>kc_house %&gt;%
  mutate(built_decade = floor(built_yr / 10)) %&gt;%
  group_by(built_decade) %&gt;%
  summarise(XX = XX,
            XX = XX(XX))</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>A friend of yours who is getting into Seattle real estate wants to know how the number of floors a house has affects its selling price. Create a table for her showing the minimum, mean, and maximum price for houses separated by the number of floors they have.</li>
</ol>
</div>
<div id="e---multiple-groups" class="section level3">
<h3>E - Multiple groups</h3>
<ol style="list-style-type: decimal">
<li>Your friend Brumhilda is interested in statistics on houses in the following 4 zipcodes only: 98001, 98109, 98117, 98199. Create a new dataframe called <code>brumhilda</code> that only contains data from houses in those zipcode (hint: use <code>filter()</code> combined with the <code>%in%</code> operator as follows:</li>
</ol>
<pre class="r"><code>brumhilda &lt;- kc_house %&gt;%
  filter(XXX %in% c(XXX, XXX, XXX, XXX))</code></pre>
<pre class="r"><code>brumhilda &lt;- kc_house %&gt;%
  filter(zipcode %in% c(98001, 98109, 98117, 98199))</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>For each of the zip codes, calculate the <code>mean()</code> and <code>median()</code> selling price (as well as the number of houses) in each zip code.</li>
</ol>
<pre class="r"><code>brumhilda %&gt;%
  group_by(zipcode) %&gt;%
  summarise(price_mean = mean(price),
           price_median = median(price),
           N = n())</code></pre>
<pre><code># A tibble: 4 x 4
  zipcode price_mean price_median     N
    &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;int&gt;
1   98001    280805.       260000   362
2   98109    879624.       736000   109
3   98117    576795.       544000   553
4   98199    791821.       689800   317</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Now Brumhilda wants the same data separated by whether or not the house is a mansion or not. Include these results by also grouping the data by <code>mansion</code> (as well as <code>zipcode</code>), and calculating the same summary statistics as before.</li>
</ol>
<pre class="r"><code>brumhilda %&gt;%
  group_by(zipcode, mansion) %&gt;%
  summarise(price_mean = mean(price),
           price_median = median(price),
           N = n())</code></pre>
<pre><code># A tibble: 8 x 5
# Groups:   zipcode [4]
  zipcode mansion price_mean price_median     N
    &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;        &lt;dbl&gt; &lt;int&gt;
1   98001 No         277589.       260000   359
2   98001 Yes        665667.       637000     3
3   98109 No         833528.       730500   106
4   98109 Yes       2508333.      2900000     3
5   98117 No         575626.       543000   551
6   98117 Yes        898750        898750     2
7   98199 No         753625.       675000   305
8   98199 Yes       1762618.      1425000    12</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Ok that was good, but now she also wants to know what the maximum and minimum number of floors were in each group. Add these summary statistics!</li>
</ol>
<pre class="r"><code>brumhilda %&gt;%
  group_by(zipcode) %&gt;%
  summarise(price_mean = mean(price),
           price_median = median(price),
           floors_min = min(floors),
           floors_max = max(floors),
           N = n())</code></pre>
<pre><code># A tibble: 4 x 6
  zipcode price_mean price_median floors_min floors_max     N
    &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt;
1   98001    280805.       260000          1        2.5   362
2   98109    879624.       736000          1        3     109
3   98117    576795.       544000          1        3     553
4   98199    791821.       689800          1        3     317</code></pre>
</div>
<div id="f---statistics" class="section level3">
<h3>F - Statistics</h3>
<ol style="list-style-type: decimal">
<li>Let’s see if there is a significant difference between the selling prices of houses on the waterfront versus those not on the waterfront. To do this, we’ll conduct a t-test using the <code>t.test()</code> function and assign the result to <code>waterfront_htest</code>. Fill in the XXXs in the code below, such that the dependent variable is <code>price</code> and the independent variable is <code>waterfront</code></li>
</ol>
<pre class="r"><code>waterfront_htest &lt;- t.test(formula = XXX ~ XXX,
                           data = XXX)</code></pre>
<pre class="r"><code>waterfront_htest &lt;- t.test(formula = price ~ waterfront,
                           data = kc_house)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Print your <code>waterfront_htest</code> object to see a printout of the main results.</li>
</ol>
<pre class="r"><code>waterfront_htest</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  price by waterfront
t = -10, df = 200, p-value &lt;2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -1303662  -956963
sample estimates:
mean in group 0 mean in group 1 
         531564         1661876 </code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Look at the names of your <code>waterfront_htest</code> object with <code>names()</code>.</li>
</ol>
<pre class="r"><code>names(waterfront_htest)</code></pre>
<pre><code>[1] &quot;statistic&quot;   &quot;parameter&quot;   &quot;p.value&quot;     &quot;conf.int&quot;    &quot;estimate&quot;   
[6] &quot;null.value&quot;  &quot;alternative&quot; &quot;method&quot;      &quot;data.name&quot;  </code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Using the <code>$</code>, print the test statistic (<code>statistic</code>) from your <code>waterfront_htest</code> object.</li>
</ol>
<pre class="r"><code>waterfront_htest$statistic</code></pre>
<pre><code>    t 
-12.9 </code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Now using <code>$</code>, print only the p-value (<code>p.value</code>) from the object.</li>
</ol>
<pre class="r"><code>waterfront_htest$p.value</code></pre>
<pre><code>[1] 1.38e-26</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Which of the variables <code>bedrooms</code>, <code>bathrooms</code>, <code>living_sqm</code>, <code>waterfront</code>, <code>lat</code> and <code>long</code> best predict a house’s price (<code>price</code>)? Answer this by conducting a regression analysis using the <code>glm()</code> function and assign the result to <code>price_glm</code>. Fill in the XXXs in the code below.</li>
</ol>
<pre class="r"><code>price_glm &lt;- glm(formula = XXX ~ XXX + XXX + XXX + XXX + XXX + XXX,
                 data = XXX)</code></pre>
<pre class="r"><code>price_glm &lt;- glm(formula = price ~ bedrooms + bathrooms + living_sqm + waterfront + lat + long,
                 data = kc_house)</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>Print your <code>price_glm</code> object. What do you see?</li>
</ol>
<pre class="r"><code>price_glm</code></pre>
<pre><code>
Call:  glm(formula = price ~ bedrooms + bathrooms + living_sqm + waterfront + 
    lat + long, data = kc_house)

Coefficients:
(Intercept)     bedrooms    bathrooms   living_sqm   waterfront  
  -65680578       -46146        17422         3157       790264  
        lat         long  
     675209      -275008  

Degrees of Freedom: 21612 Total (i.e. Null);  21606 Residual
Null Deviance:      2.91e+15 
Residual Deviance: 1.09e+15     AIC: 594000</code></pre>
<ol start="8" style="list-style-type: decimal">
<li>Look at the names of your <code>price_glm</code> object with <code>names()</code>.</li>
</ol>
<pre class="r"><code>names(price_glm)</code></pre>
<pre><code> [1] &quot;coefficients&quot;      &quot;residuals&quot;         &quot;fitted.values&quot;    
 [4] &quot;effects&quot;           &quot;R&quot;                 &quot;rank&quot;             
 [7] &quot;qr&quot;                &quot;family&quot;            &quot;linear.predictors&quot;
[10] &quot;deviance&quot;          &quot;aic&quot;               &quot;null.deviance&quot;    
[13] &quot;iter&quot;              &quot;weights&quot;           &quot;prior.weights&quot;    
[16] &quot;df.residual&quot;       &quot;df.null&quot;           &quot;y&quot;                
[19] &quot;converged&quot;         &quot;boundary&quot;          &quot;model&quot;            
[22] &quot;call&quot;              &quot;formula&quot;           &quot;terms&quot;            
[25] &quot;data&quot;              &quot;offset&quot;            &quot;control&quot;          
[28] &quot;method&quot;            &quot;contrasts&quot;         &quot;xlevels&quot;          </code></pre>
<ol start="9" style="list-style-type: decimal">
<li>Using <code>$</code> print the coefficients from your analysis.</li>
</ol>
<pre class="r"><code>price_glm$coefficients</code></pre>
<pre><code>(Intercept)    bedrooms   bathrooms  living_sqm  waterfront         lat 
  -65680578      -46146       17422        3157      790264      675209 
       long 
    -275008 </code></pre>
<ol start="10" style="list-style-type: decimal">
<li>Using the <code>summary()</code> function, show summary results from your <code>price_glm</code> object.</li>
</ol>
<pre class="r"><code>summary(price_glm)</code></pre>
<pre><code>
Call:
glm(formula = price ~ bedrooms + bathrooms + living_sqm + waterfront + 
    lat + long, data = kc_house)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1563708   -116127    -14138     84523   4180382  

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -6.57e+07   1.41e+06  -46.51  &lt; 2e-16 ***
bedrooms    -4.61e+04   2.05e+03  -22.53  &lt; 2e-16 ***
bathrooms    1.74e+04   3.07e+03    5.67  1.4e-08 ***
living_sqm   3.16e+03   2.95e+01  107.17  &lt; 2e-16 ***
waterfront   7.90e+05   1.79e+04   44.14  &lt; 2e-16 ***
lat          6.75e+05   1.12e+04   60.20  &lt; 2e-16 ***
long        -2.75e+05   1.14e+04  -24.15  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 5.06e+10)

    Null deviance: 2.9129e+15  on 21612  degrees of freedom
Residual deviance: 1.0943e+15  on 21606  degrees of freedom
AIC: 594064

Number of Fisher Scoring iterations: 2</code></pre>
<ol start="11" style="list-style-type: decimal">
<li>The <code>$residuals</code> element in your <code>price_glm</code> object contains the residuals (difference from the predicted and true dependent variable values). Add this vector as a new column called <code>residuals</code> to your <code>kc_house</code> object using <code>mutate()</code></li>
</ol>
<pre class="r"><code>kc_house &lt;- kc_house %&gt;%
  mutate(residuals = price_glm$residuals)</code></pre>
<ol start="12" style="list-style-type: decimal">
<li>Using the following template, create a histogram of the residuals.</li>
</ol>
<pre class="r"><code>ggplot(data = kc_house,
       aes(x = residuals)) +
  geom_histogram(col = &quot;white&quot;) +
  labs(title = &quot;Residual regression&quot;)</code></pre>
<pre class="r"><code>ggplot(data = kc_house,
       aes(x = residuals)) +
  geom_histogram(col = &quot;white&quot;) +
  labs(title = &quot;Residual regression&quot;)</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Analysing_practical_files/figure-html/unnamed-chunk-53-1.png" width="576" style="display: block; margin: auto;" /></p>
<ol start="12" style="list-style-type: decimal">
<li>What is the mean of the residuals? How do you interpret this?</li>
</ol>
<pre class="r"><code>kc_house %&gt;% 
  summarise(resid_mean = mean(residuals))</code></pre>
<pre><code># A tibble: 1 x 1
    resid_mean
         &lt;dbl&gt;
1 -0.000000151</code></pre>
<ol start="13" style="list-style-type: decimal">
<li>Now, create a new column called <code>residuals_abs</code> which shows the absolute value of the residuals (hint: use the <code>abs()</code> function).</li>
</ol>
<pre class="r"><code>kc_house &lt;- kc_house %&gt;%
  mutate(residuals_abs = abs(price_glm$residuals))</code></pre>
<ol start="14" style="list-style-type: decimal">
<li>Create a histogram of the absolute value of the residuals.</li>
</ol>
<pre class="r"><code>ggplot(data = kc_house,
       aes(x = residuals_abs)) +
  geom_histogram(col = &quot;white&quot;) +
  labs(title = &quot;Residual regression&quot;)</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Analysing_practical_files/figure-html/unnamed-chunk-56-1.png" width="576" style="display: block; margin: auto;" /></p>
<ol start="15" style="list-style-type: decimal">
<li>What is the mean of the absolute value of the residuals? How do you interpret this? In general, do you think you can predict the price of a house very well based on the features in your regression model?</li>
</ol>
<pre class="r"><code>kc_house %&gt;% 
  summarise(resid_abs_mean = mean(residuals_abs))</code></pre>
<pre><code># A tibble: 1 x 1
  resid_abs_mean
           &lt;dbl&gt;
1        144018.</code></pre>
<pre class="r"><code># On average, the model&#39;s fitted values are off by 144,018. So the model isn&#39;t terribly accurate on average.</code></pre>
</div>
<div id="x---challenges" class="section level3">
<h3>X - Challenges</h3>
<ol style="list-style-type: decimal">
<li>Which zipcode has the highest percentage of houses on the waterfront? (Hint: group by zipcode, calculate the percentage of houses on the waterfront using <code>mean()</code>, then sort the data in descending order) with <code>arrange()</code>, then select the first row with <code>slice()</code>. Once you find it, try searching for that zipcode on Google Maps and see if its location makes sense!</li>
</ol>
<pre class="r"><code>kc_house %&gt;%
  group_by(zipcode) %&gt;%
  summarise(waterfront_p = mean(waterfront)) %&gt;%
  arrange(desc(waterfront_p)) %&gt;%
  slice(1)</code></pre>
<pre><code># A tibble: 1 x 2
  zipcode waterfront_p
    &lt;dbl&gt;        &lt;dbl&gt;
1   98070        0.203</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Which house had the highest price to living space ratio? To answer this, create a new variable called <code>price_to_living</code> that takes <code>price / living_sqm</code>. Then, sort the data in descending order of this variable, and select the first row with <code>slice()</code>! What id value do you get?</li>
</ol>
<pre class="r"><code>kc_house %&gt;%
  mutate(price_to_living = price / living_sqm) %&gt;%
  arrange(desc(price_to_living)) %&gt;%
  slice(1)</code></pre>
<pre><code># A tibble: 1 x 29
  id    date                 price bedrooms bathrooms living_sqft lot_sqft
  &lt;chr&gt; &lt;dttm&gt;               &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;
1 6021… 2015-04-07 00:00:00 874950        2         1        1080     4000
# … with 22 more variables: floors &lt;dbl&gt;, waterfront &lt;dbl&gt;, view &lt;dbl&gt;,
#   condition &lt;dbl&gt;, grade &lt;dbl&gt;, above_sqft &lt;dbl&gt;, basement_sqft &lt;dbl&gt;,
#   built_yr &lt;dbl&gt;, renovated_yr &lt;dbl&gt;, zipcode &lt;dbl&gt;, lat &lt;dbl&gt;,
#   long &lt;dbl&gt;, sqft_living15 &lt;dbl&gt;, sqft_lot15 &lt;dbl&gt;, living_sqm &lt;dbl&gt;,
#   above_sqm &lt;dbl&gt;, basement_sqm &lt;dbl&gt;, total_sqm &lt;dbl&gt;, mansion &lt;chr&gt;,
#   residuals &lt;dbl&gt;, residuals_abs &lt;dbl&gt;, price_to_living &lt;dbl&gt;</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Which are the top 10 zip codes in terms of mean housing prices? To answer this, group the data by zipcode, calculate the mean price, arrange the dataset in descending order of mean price, then select the top 10 rows!</li>
</ol>
<pre class="r"><code>kc_house %&gt;%
  group_by(zipcode) %&gt;%
  summarise(price_mean = mean(price)) %&gt;%
  arrange(desc(price_mean)) %&gt;%
  slice(1:10)</code></pre>
<pre><code># A tibble: 10 x 2
   zipcode price_mean
     &lt;dbl&gt;      &lt;dbl&gt;
 1   98039   2160607.
 2   98004   1355927.
 3   98040   1194230.
 4   98112   1095499.
 5   98102    901258.
 6   98109    879624.
 7   98105    862825.
 8   98006    859685.
 9   98119    849448.
10   98005    810165.</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Create the following dataframe <em>exactly</em> as it appears.</li>
</ol>
<table>
<thead>
<tr class="header">
<th align="right">built_yr</th>
<th align="right">N</th>
<th align="right">price_mean</th>
<th align="right">price_max</th>
<th align="right">living_sqm_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1990</td>
<td align="right">320</td>
<td align="right">563966</td>
<td align="right">3640900</td>
<td align="right">234</td>
</tr>
<tr class="even">
<td align="right">1991</td>
<td align="right">224</td>
<td align="right">630441</td>
<td align="right">5300000</td>
<td align="right">244</td>
</tr>
<tr class="odd">
<td align="right">1992</td>
<td align="right">198</td>
<td align="right">548169</td>
<td align="right">2480000</td>
<td align="right">223</td>
</tr>
<tr class="even">
<td align="right">1993</td>
<td align="right">202</td>
<td align="right">556612</td>
<td align="right">3120000</td>
<td align="right">226</td>
</tr>
<tr class="odd">
<td align="right">1994</td>
<td align="right">249</td>
<td align="right">486834</td>
<td align="right">2880500</td>
<td align="right">209</td>
</tr>
<tr class="even">
<td align="right">1995</td>
<td align="right">169</td>
<td align="right">577771</td>
<td align="right">3200000</td>
<td align="right">224</td>
</tr>
<tr class="odd">
<td align="right">1996</td>
<td align="right">195</td>
<td align="right">639534</td>
<td align="right">3100000</td>
<td align="right">240</td>
</tr>
<tr class="even">
<td align="right">1997</td>
<td align="right">177</td>
<td align="right">606058</td>
<td align="right">3800000</td>
<td align="right">234</td>
</tr>
<tr class="odd">
<td align="right">1998</td>
<td align="right">239</td>
<td align="right">594159</td>
<td align="right">1960000</td>
<td align="right">241</td>
</tr>
</tbody>
</table>
<pre class="r"><code>kc_house %&gt;%
  filter(built_yr &gt;= 1990 &amp; built_yr &lt; 1999) %&gt;%
  group_by(built_yr) %&gt;%
  summarise(N = n(),
            price_mean = mean(price),
            price_max = max(price),
            living_sqm_mean = mean(living_sqm)) %&gt;%
  knitr::kable(digits = 0)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">built_yr</th>
<th align="right">N</th>
<th align="right">price_mean</th>
<th align="right">price_max</th>
<th align="right">living_sqm_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1990</td>
<td align="right">320</td>
<td align="right">563966</td>
<td align="right">3640900</td>
<td align="right">234</td>
</tr>
<tr class="even">
<td align="right">1991</td>
<td align="right">224</td>
<td align="right">630441</td>
<td align="right">5300000</td>
<td align="right">244</td>
</tr>
<tr class="odd">
<td align="right">1992</td>
<td align="right">198</td>
<td align="right">548169</td>
<td align="right">2480000</td>
<td align="right">223</td>
</tr>
<tr class="even">
<td align="right">1993</td>
<td align="right">202</td>
<td align="right">556612</td>
<td align="right">3120000</td>
<td align="right">226</td>
</tr>
<tr class="odd">
<td align="right">1994</td>
<td align="right">249</td>
<td align="right">486834</td>
<td align="right">2880500</td>
<td align="right">209</td>
</tr>
<tr class="even">
<td align="right">1995</td>
<td align="right">169</td>
<td align="right">577771</td>
<td align="right">3200000</td>
<td align="right">224</td>
</tr>
<tr class="odd">
<td align="right">1996</td>
<td align="right">195</td>
<td align="right">639534</td>
<td align="right">3100000</td>
<td align="right">240</td>
</tr>
<tr class="even">
<td align="right">1997</td>
<td align="right">177</td>
<td align="right">606058</td>
<td align="right">3800000</td>
<td align="right">234</td>
</tr>
<tr class="odd">
<td align="right">1998</td>
<td align="right">239</td>
<td align="right">594159</td>
<td align="right">1960000</td>
<td align="right">241</td>
</tr>
</tbody>
</table>
<ol start="5" style="list-style-type: decimal">
<li>Create a regression object called <code>living_glm</code> predicting the amount of living space (<code>living_sqm</code>) as a function of <code>bedrooms</code>, <code>bathrooms</code>, <code>waterfront</code>, and <code>built_yr</code>. Explore the object with <code>names()</code> and <code>summary()</code>. Which variables seem to predict living space?</li>
</ol>
<pre class="r"><code>living_glm &lt;- glm(formula = living_sqm ~ bedrooms + bathrooms + waterfront + built_yr,
                  data = kc_house)

names(living_glm)</code></pre>
<pre><code> [1] &quot;coefficients&quot;      &quot;residuals&quot;         &quot;fitted.values&quot;    
 [4] &quot;effects&quot;           &quot;R&quot;                 &quot;rank&quot;             
 [7] &quot;qr&quot;                &quot;family&quot;            &quot;linear.predictors&quot;
[10] &quot;deviance&quot;          &quot;aic&quot;               &quot;null.deviance&quot;    
[13] &quot;iter&quot;              &quot;weights&quot;           &quot;prior.weights&quot;    
[16] &quot;df.residual&quot;       &quot;df.null&quot;           &quot;y&quot;                
[19] &quot;converged&quot;         &quot;boundary&quot;          &quot;model&quot;            
[22] &quot;call&quot;              &quot;formula&quot;           &quot;terms&quot;            
[25] &quot;data&quot;              &quot;offset&quot;            &quot;control&quot;          
[28] &quot;method&quot;            &quot;contrasts&quot;         &quot;xlevels&quot;          </code></pre>
<pre class="r"><code>summary(living_glm)</code></pre>
<pre><code>
Call:
glm(formula = living_sqm ~ bedrooms + bathrooms + waterfront + 
    built_yr, data = kc_house)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-705.7   -32.0    -4.9    25.7   566.1  

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 219.6403    27.7140    7.93  2.4e-15 ***
bedrooms     23.1621     0.4532   51.11  &lt; 2e-16 ***
bathrooms    71.3214     0.6294  113.31  &lt; 2e-16 ***
waterfront   62.5121     4.1476   15.07  &lt; 2e-16 ***
built_yr     -0.1297     0.0143   -9.09  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 2750)

    Null deviance: 157675161  on 21612  degrees of freedom
Residual deviance:  59420739  on 21608  degrees of freedom
AIC: 232503

Number of Fisher Scoring iterations: 2</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>The <code>chisq.test()</code> function allows you to do conduct a chi square test testing the relationship between two nominal variables. Look at the help menu to see how the function works. Then, conduct a chi-square test to see if there is a relationship between whether a house is on the waterfront and the grade of the house. Do houses on the waterfront tend to have higher (or lower) grades than houses not on the waterfront?</li>
</ol>
<pre class="r"><code># First look at a table

table(kc_house$waterfront, kc_house$grade)</code></pre>
<pre><code>   
       1    3    4    5    6    7    8    9   10   11   12   13
  0    1    3   29  238 2026 8958 6028 2590 1106  379   79   13
  1    0    0    0    4   12   23   40   25   28   20   11    0</code></pre>
<pre class="r"><code>chisq.test(table(kc_house$waterfront, kc_house$grade))</code></pre>
<pre><code>
    Pearson&#39;s Chi-squared test

data:  table(kc_house$waterfront, kc_house$grade)
X-squared = 300, df = 10, p-value &lt;2e-16</code></pre>
</div>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<pre class="r"><code># Analysing with dplyr and tidyr ---------------------------

library(tidyverse)    # Load tidyverse for dplyr
library(broom)        # For tidy results
library(rsq)          # For r-squared values

# Load baselers data
baselers &lt;- read_csv(&quot;1_Data/baselers.txt&quot;)

# No grouping variables

bas &lt;- baselers %&gt;%
  summarise(
    age_mean = mean(age, na.rm = TRUE),
    income_median = median(income, na.rm = TRUE),
    N = n()
  )

# One grouping variable
bas_sex &lt;- baselers %&gt;%
  group_by(sex) %&gt;%
  summarise(
    age_mean = mean(age, na.rm = TRUE),
    income_median = median(income, na.rm = TRUE),
    N = n()
  )

bas_sex

# Two grouping variables
bas_sex_ed &lt;- baselers %&gt;%
  group_by(sex, education) %&gt;%
  summarise(
    age_mean = mean(age, na.rm = TRUE),
    income_median = median(income, na.rm = TRUE),
    N = n()
  )

# Advanced scoping

# Calculate mean of ALL numeric variables
baselers %&gt;%
  group_by(sex, education) %&gt;%
  summarise_if(is.numeric, mean, na.rm = TRUE)


# Examples of hypothesis tests on the diamonds -------------

# First few rows of the diamonds data

diamonds


# 2-sample t- test ---------------------------

# Q: Is there a difference in the carats of color = E and color = I diamonds?

htest_B &lt;- t.test(formula = carat ~ color,     # DV ~ IV
                   alternative = &quot;two.sided&quot;,  # Two-sided test
                   data = diamonds,         # The data
                   subset = color %in% c(&quot;E&quot;, &quot;I&quot;)) # Compare Diet 1 and Diet 2

htest_B  # Print result

# Regression ----------------------------

# Q: Create regression equation predicting price by carat, depth, table, and x

price_glm &lt;- glm(formula = price ~ carat + depth + table + x,
                  data = diamonds)

# Print coefficients
price_glm$coefficients

# Tidy version
tidy(price_glm)

# Extract R-Squared
rsq(price_glm)</code></pre>
</div>
<div id="datasets" class="section level2">
<h2>Datasets</h2>
<table>
<colgroup>
<col width="8%" />
<col width="10%" />
<col width="11%" />
<col width="70%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">File</th>
<th align="left">Rows</th>
<th align="left">Columns</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="https://raw.githubusercontent.com/therbootcamp/BaselRBootcamp_2018July/master/_sessions/_data/baselrbootcamp_data/kc_house.csv">kc_house.csv</a></td>
<td align="left">21613</td>
<td align="left">21</td>
<td align="left">House sale prices for King County between May 2014 and May 2015.</td>
</tr>
</tbody>
</table>
<p><em>First 5 rows and 5 columns of kc_house.csv</em></p>
<table>
<thead>
<tr class="header">
<th align="left">id</th>
<th align="left">date</th>
<th align="right">price</th>
<th align="right">bedrooms</th>
<th align="right">bathrooms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">6762700020</td>
<td align="left">2014-10-13</td>
<td align="right">7700000</td>
<td align="right">6</td>
<td align="right">8.00</td>
</tr>
<tr class="even">
<td align="left">9808700762</td>
<td align="left">2014-06-11</td>
<td align="right">7062500</td>
<td align="right">5</td>
<td align="right">4.50</td>
</tr>
<tr class="odd">
<td align="left">9208900037</td>
<td align="left">2014-09-19</td>
<td align="right">6885000</td>
<td align="right">6</td>
<td align="right">7.75</td>
</tr>
<tr class="even">
<td align="left">2470100110</td>
<td align="left">2014-08-04</td>
<td align="right">5570000</td>
<td align="right">5</td>
<td align="right">5.75</td>
</tr>
<tr class="odd">
<td align="left">8907500070</td>
<td align="left">2015-04-13</td>
<td align="right">5350000</td>
<td align="right">5</td>
<td align="right">5.00</td>
</tr>
</tbody>
</table>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<div id="packages" class="section level3">
<h3>Packages</h3>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Package</th>
<th align="left">Installation</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>tidyverse</code></td>
<td align="left"><code>install.packages(&quot;tidyverse&quot;)</code></td>
<td align="left">A collection of packages for data science, including <code>dplyr</code>, <code>ggplot2</code> and others</td>
</tr>
<tr class="even">
<td align="left"><code>broom</code></td>
<td align="left"><code>install.packages(&quot;broom&quot;)</code></td>
<td align="left">Provides ‘tidy’ outputs from statistical objects.</td>
</tr>
<tr class="odd">
<td align="left"><code>rsq</code></td>
<td align="left"><code>install.packages(&quot;rsq&quot;)</code></td>
<td align="left">Returns r-squared statistics from <code>glm</code> objects.</td>
</tr>
</tbody>
</table>
</div>
<div id="functions-1" class="section level3">
<h3>Functions</h3>
<p><em>Wrangling</em></p>
<table>
<colgroup>
<col width="7%" />
<col width="12%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Package</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rename()</code></td>
<td align="left"><code>dplyr</code></td>
<td align="left">Rename columns</td>
</tr>
<tr class="even">
<td align="left"><code>select()</code></td>
<td align="left"><code>dplyr</code></td>
<td align="left">Select columns based on name or index</td>
</tr>
<tr class="odd">
<td align="left"><code>filter()</code></td>
<td align="left"><code>dplyr</code></td>
<td align="left">Select rows based on some logical criteria</td>
</tr>
<tr class="even">
<td align="left"><code>arrange()</code></td>
<td align="left"><code>dplyr</code></td>
<td align="left">Sort rows</td>
</tr>
<tr class="odd">
<td align="left"><code>mutate()</code></td>
<td align="left"><code>dplyr</code></td>
<td align="left">Add new columns</td>
</tr>
<tr class="even">
<td align="left"><code>case_when()</code></td>
<td align="left"><code>dplyr</code></td>
<td align="left">Recode values of a column</td>
</tr>
<tr class="odd">
<td align="left"><code>group_by(), summarise()</code></td>
<td align="left"><code>dplyr</code></td>
<td align="left">Group data and then calculate summary statistics</td>
</tr>
<tr class="even">
<td align="left"><code>left_join()</code></td>
<td align="left"><code>dplyr</code></td>
<td align="left">Combine multiple data sets using a key column</td>
</tr>
</tbody>
</table>
<p><em>Statistical Tests</em></p>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Package</th>
<th align="left">Hypothesis Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>glm()</code>, <code>lm()</code></td>
<td align="left"><code>base</code></td>
<td align="left">Generalized linear model and linear model</td>
</tr>
<tr class="even">
<td align="left"><code>t.test()</code></td>
<td align="left"><code>base</code></td>
<td align="left">One and two sample t-test</td>
</tr>
<tr class="odd">
<td align="left"><code>wilcox.test()</code></td>
<td align="left"><code>base</code></td>
<td align="left">Wilcoxon test</td>
</tr>
<tr class="even">
<td align="left"><code>cor.test()</code></td>
<td align="left"><code>base</code></td>
<td align="left">Correlation test</td>
</tr>
<tr class="odd">
<td align="left"><code>chisq.test</code></td>
<td align="left"><code>base</code></td>
<td align="left">Chi-square tests for frequency tables</td>
</tr>
</tbody>
</table>
<p><em>Other</em></p>
<table>
<colgroup>
<col width="20%" />
<col width="22%" />
<col width="57%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Package</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>tidy()</code></td>
<td align="left"><code>broom</code></td>
<td align="left">Converts statistical objects to ‘tidy’ dataframes of key results</td>
</tr>
<tr class="even">
<td align="left"><code>rsq()</code></td>
<td align="left"><code>rsq</code></td>
<td align="left">Returns r-squared statistics from glm objects</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="resources" class="section level2">
<h2>Resources</h2>
<div id="dplyr-vignette" class="section level3">
<h3><code>dplyr</code> vignette</h3>
<p>See the full <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html">dplyr vignette</a> with lots of wrangling tips and tricks.</p>
</div>
<div id="cheatsheets" class="section level3">
<h3>Cheatsheets</h3>
<p align="center" width="100%">
<a href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf"> <img src="https://image.slidesharecdn.com/data-wrangling-cheatsheet-160705210122/95/data-wrangling-with-dplyr-and-tidyr-cheat-sheet-1-638.jpg?cb=1467752577" style="width:70%"></a> <br> <font style="font-size:10px">from <a href="https://www.rstudio.com/resources/cheatsheets/">R Studio</a></font>
</p>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
